#summary 如何合并 PO 文件？
[Newbie 回到新手指南]
= 简介 =
 对于很大的 PO 文件，经常需要协作翻译。于是，在翻译完成后，大家需要合并翻译。
 建议大家使用标准格式，格式化方法参见 [Newbie]，[Flow] 等页面。
 同时，如果你以前翻译过的一个文件现在有了新版本的话，最好最方便的作法也是用 merge。

= 方法 =
== 升级原来已经翻译过的文件 ==
 这是最常见的情况了。由于程序升级，导致相应的 po 文件发生改变。作者将最新的 po 上传给了 TP。默认情况下，如果该软件以前曾经分派给你翻译的话，那你将会是新 po 文件的指定翻译者，不必再去申请了。
 方法也简单。只要将新版本的 pot 文件跟原来翻译好的 po 文件放在同一个目录下。然后运行
 * msgmerge -U old.po new.pot 
 就行了。合并过的文件将以 old.po 命名，原有的 old.po 将被改为 old.po~。然后你要做的就是，在生成的的 po 上进行修订，最后用 svn ci 直接上传就 OK 了。old.po~ 会被 svn 自动忽略。如果你要觉得它不爽的话，直接用 rm old.po~ 删除就行了，因为这个文件是不受 svn 版本控制的。

== 大家使用同一 pot 文件，同一翻译格式 ==
 这是通常情况，翻译和提交流程如下：
  # 开始翻译
  # 复审翻译
  # 更新到最新版本的 PO 文件
  # 如果产生合并冲突，说明有翻译同样条目的情况出现。用文本编辑器打开 PO 文件，手工解决冲突，然后回到步骤2
  # 如果提交失败，报告服务器上有新版本，那么回到步骤3

== 大家使用同一 pot 文件，不同翻译格式 ==
 这种情况应该禁止，大家要采用一致的翻译格式。
 合并方法很简单，假设有 foo.pot，zh_CN-A.po，zh_CN-B.po 三个文件，合并方法如下：
  # python po-merge.py<zh_CN-A.po zh_CN-B.po
  # msgmerge --no-wrap -o zh_CN-new.po zh_CN-B.po foo.pot
  # mv -f zh_CN-new.po zh_CN.po

 产生的结果是文件 zh_CN.po，它以 A 的翻译为准，如果 A 和 B 翻译了相同的条目，那么采用 A 的翻译。如果要以 B 的翻译为准，将命令中的 A 和 B 互换即可。最后两个命令是格式化合并结果的。

 其中 po-merge.py 位于 trunk/lib/tools，它是从官方 Subversion 版本库复制而来，即 trunk/tools/dev/po-merge.py。

 也可以使用 pomerge 来合并，参见 http://translate.sourceforge.net/wiki/toolkit/pomerge 。

== 大家使用不同 pot 文件，不同翻译格式 ==
 这种情况应该禁止，大家要采用一致的翻译格式，优先翻译高版本，然后从高版本移植到低版本，最后翻译低版本剩余的部分。

 合并方法稍微复杂，如果两个 pot 文件是两个版本分支，那么要对于每个 pot 文件，执行*大家使用同一 pot 文件，不同翻译格式*。否则，直接对最新的 pot 文件，执行*大家使用同一 pot 文件，不同翻译格式*即可。
[Newbie 回到新手指南]